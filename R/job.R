# options(tidyverse.quiet = TRUE)
# library(tidyverse, quietly = T, warn.conflicts = F)
#library(rvest, quietly = T, warn.conflicts = F)
#library(httr, quietly = T, warn.conflicts = F)

library(tidyverse)
library(rvest)
library(dplyr)
library(readr)
library(stringr)
library(googlesheets4)
library(googledrive)
library(sodium)


print(paste0("interactive is: ", interactive()))


googlesheets_key_raw <- Sys.getenv("SHEETS_KEY") %>% sodium::hex2bin()

print(length(googlesheets_key_raw))
print(getwd())

googlesheets_nonce_raw <- "bbb2cbfef0e850069fc5d955b037f407cd490114e72067e3" %>% sodium::hex2bin()

service_encrypted <- readRDS("service_token_encrypted.RDS")

service_decrypted <- service_encrypted %>%
  sodium::data_decrypt(key = googlesheets_key_raw, nonce = googlesheets_nonce_raw) %>%
  unserialize(NULL)

drive_auth(path = rawToChar(service_decrypted))
gs4_auth(path = rawToChar(service_decrypted))

# gsheet_decrypted_raw <- c("0ced9ba7d14e3b712ed941e84bc01970de341345df7b425e5e1bef8ed785956fbe764af91199229d6f3724224ea486c31452ea0be8dc778707c0095f38451123f3ac5a5d944fac256d1d8941670a7e7c10055400f421a678cd58b0e7ced598ce3a5d9d1ee2411fdfe8c8033ce2a68b4258f37ee448bb82ce1614cd74172811664c74cb5646cbe6e79a7fd6dd50a60eb129b701bf3fcb7c371533f2dcf859a7d178fbce6f062aefa151742f094c6e3d208615044a1b6c44329ef0c5a37927a4a796225a414add2f0c0743ad0ec74412e30a31501c57f93a6b16b6d89ce8e4b5f5ac789dcc5a41f97447b84b985cbcc9703f73222bc6dfe02e9bf8eaef9d2f633e6c4940a7e3652a18f43485eaf852020be4fc7f9c19b0979c8eba3e554b9a4de37d19baefd2eb9ad8f09257d3468a2855af95c1429f397bea14a8374241b3b283a4965a7e6c09ad2fdfca9f2fd81e14d1af25e96cb501e4820768a661ff2975f97718f001b59625b6544e0cac3a11ef82aeef56acd8f17018a9e7c890b8746f1baee11258a12b12c8d26c13f5ee982e307dae8fbac9b427c8c3cd35e12b83c1d3606907b23d708f2ec8cc7e2e166376e83aae3c3076fc0d082d8e112f92af70471cf50a9f5c2d7723bc392e29d1b20ab0078beed049f0b1ab2f56024e00eacea84c3411988dbfcb78805ca18f47fb0f86a1f32f5063c67c51f770f3a0fe9c23db3ed611fd778f67606fbeec3f85b4ed66e568e3f6e7a48415832172ba096ab334088b72bd1920e514cb0634588b9cf52220033ccf36e8f7d1bacc67f0c657c1b6f193e2aeab7c7773cc5aa0ddc03f47e2276b13fa229f512b016f6b5c9250a28d000f23d8b0ef28dbcabfc7d731982b57bb041db57affb05580b68760cd92ca5009e941a7673bba2c90562a8285dcaa48446cd717eea1c4566228f57ac7776c92d94073dcc312a50d52f043d84988c7ef6a7745adfa523b7dcf336de079012f8cc8cb62189d4f66a84839e71b61267e9a1a50938ed638891e960aa73325e403f37782ecea76795d0a697224befb97d2d4e5682269317a98b9de02cde8d0de62de2adb8e57cafecba50a4883107c63fa33e344fcd697987a3c6d56226c8874d06c50d052f523444c0ed5df458e9c1cdb9b5b793686596588edbd966d4fcf8c751119146fad480d8e99285ccd247780131660bcec206c77fd257e4bd01a83559a17070c7c7741d8cf83caac5ee3594d33975c4760155a853444407beba9792e601b33f8f71fd3c03f637ceaffd2da71173b1d87bb9743756a3f6db82cf2e5dd67869218a86b19fbb5c2d762043df540117486c62f63270588b30f6aac0a0ef6c83d096bb554c4d59203269c11fbd1f53976f52f4a195ecfefc3aa26458997cb4b031e8551bffcdb5e171d09cee7772b2ae2bbaa2904790f18a6378ef807c53002c5e3b0361ab81af8915e02b21b6a8042d632726e47d15255402a6df1f09830e86d6d68cafab39690a986827c41730d6241157dd5b402c476de44ac2c1f6e7da9c45fadd7c95496d01cebd454e6ddd95f277102569de665dda7e0b8021a70466e613bf8e09bf625d5ab813980eb126ba11f26877e5229f2f369a9febc3a544076b765cf508ccfedbacdce1a857825ffb28339052011914224ef05ab1a3fa29e1a2f254b0e7891764891ae09f79aad24714d59a6b3e9e72d8980d806eb67f20baca7dd3b4d3eed97a28d01828620a577d939d908ccf25c4a5183ecf25ce3cc42b4b86a1e291200d4ae177559fbcf9c2d1b391f9de07bd78ec3dc65a26486c7060b2ea494bb3d1b61acf1877b47af57805de141187b6f85fd1966164feffe48ec59c2fe0a19da6e7b709e011fe4b2eeb338529f8f6caf3c467191a40b62ea88d8fae1a56245471faaa48e7ae53eaa9791c406fb960c78333f5c7c345e33d8cd4f12a4030ce06ab4ef86fd5469fab85d8976c09e67f5d37b22a61d11725897ac3a1648c29da5ac7f165fa2c204f5f389344035c6de2050a4dc408461b61a923dd38d1201457d0bb59931a4dfc4339711fad13da8482242b2e2628",
#                           "d215a3aa9a44d4bf881942c66bd8a43a9589296bebc7bf7006d06426bf2dc8a25f18330cee5f1b2cdb9da12b19d0384dc3f25eba22c2f6be29d0e954bb61a4008f77b513835e8beaa75d38996948cdc440f35f164403541693d631849478eceae0c69a4b3de88316a27d8a593116659ac40e5f27c396ad8b4ffcbb70e923284f5a9e0fa059fec9daf4d03a1671cfb9e25de4425be5d9f4ffd85aeb11fe6d7c65449c2f5600524d79fedd82d5f742329b497bb376f99da476707812d5d7ab8532ec4e417542dfc51561cd6a18315358fc064364b0ecc9291fda61eb96d7e8d2b517e9db9420f3b2240be0bc8a4177f3f4689c8e64c93ecc413617e2329aa98be4faeb0d61b3d9378e46b09cd8c3517fadccf9cfb0f314ddf222e46503474666de35cbc2e1d09a0e8349f7d18031ff48d6a10ec40f292283a972c7dc98c3784ee419eec950c2f757e5af4929fdc309589a00d5c8ea993fbd0f2fd2fe1460cbf761fc2b2463d7f9c20293aedf2e3770168d62e1dd3144ade892c83f0b02367cdad5fdc695a013a5479f53f01df82a9dfabea71fe908405c4d6b2e5e2cae58ffca35274f50889deaf1923ba3d6bf19cb86bb6bda23954fb2aefb47bdcf7f19e5094e73977a9d2e388e3edc8335ce67081aeb40a25714bc093c94e9625a1c06e1779093bcc5fc2c5532052544bfa9165129425b8be0f0a28204eb094da686ef888b867d3734badf2a1cbbb7e7cd3155864d3885387a349aa0f9847a603d22305536184fa79ab50ccbcb39d3927ad4f82979e338da88afb474db0106882a71568d41c9fd6a93fea456ff84ca2388696dc90d45fd3a0a042ad903f22cb349991926a0b0acb1594c51f61e6f161545e6133f3d06301e9c77eefdca8c4bda816d1959c9980c58219933b245121cf2611fe74a486c0a256f46f4d9f3d97884bbfdc9ff4eeec1544846de4126f11a11722c5f820fc8d2a7c3330e5dd67c344bebebd83b6eaafb68cc77f23da5ffea1e0892b968292c975df6e834d73940fc28631ac5a403540170bb6cb064dbe66662859519e91a5966512e472f935f7362f3c6ae5db40d8a9b8d112d7e79451c0f921144e009fa0be658c83d46ee0f4db05a89eff0a8fe2d8eeb9fce229680e598fc11da858298073a582f517acfe6504e87a12f8f1dfabe20fcc8af57c1ef789947242c7604fbdfdfa8937e267ff8119e7e6ada646d2d2432db6420c38b35e6a9dd0458329f7c24837be14eb0bd9c192d29d95a65e7cce3a62740aa56a3070155afa8a458b61f6d22abf3e1ed97a75da695353b50a8e7838cef00d198c65393ebb8555dc0326d73b97928bddb433371c0eab49cdf5aadfc312008405f4378d2b86ccc1abc3ac51848213f1ba7bc82c112d4fe54309a1b0d112e015bc6a45b77f9767ab437eab5b1a80f155c519924c5ef8c680e598a86a99a5aef86f87ce717b5b3b28aa41275f3b6fef8409b05973d6b1e2705e999128610306ba755e619a486d1a64ff54806a166a101232d72030c875639da7e28af367befcc4186618e0fe1a637454b01bd311226ee4dbacbc0349037534a5231a9f1cc3899bc24c34e37f73d1e12a5d8fd7b21cd20e25ed349600976e56bfeb82e653ed0d169f2f5d429711b9c810957e0c855023117e2b23a22bbe44034942ebf2b93702d8e354c3e64535f6030facbbdc9f4ad7c8d24c078fde578f67987d42c801ebf29ce3edf4fad8483a55571de5e9934d3d30d2bd891f9811d1335b0e4f96f7bfc1a93343cebf3f9caa5abc0b5cd5783d68e64c0a8f0a0b7948d21bb3f2785915f827b53ab22bf437ad154c040d1e7157ce20049c66e3f143e2a6b5ad34aa5ae69083952e8c71002f3790c117c499138b3bb1324728cf0a69d8f4fd0cc755edf482b34de98cfcd99b313b28727d240417ce42ef037d3f3351823c7d4725c6494f5505c5118fa4ea0fcf09d1990dc970584daae9fe82cfb539b1b3ea90d7374215c141beeecbfa77aa6253b7266a381e608dabc796a338d5e8c80049e2e68d6c8dc4abf2c12ec8a25f611f495231d1f62701a39f459cef",
#                           "94912d00da9be013efa4c05aca166c9dc2d8f9ef8f7d0f5e5ac5d126b236da36d29a2e64d2cd5ab6de536420663cfaae9f4165f335cc772d31cac934a5d83ac2beb45d1d4db0d5dd028e0d2a9a5dd4c0c06dc8c0e35d05886167dfeca23c8bb3f6b76652083e57aa8eed275b51f9ebe62e68d87de441716a2622a04742230c652aedc12d189c04d9c6d1aee806b59832867c04e5031c8e43e680674b8864f908ae29042103e111c622dd466d8215b3ee33ca92460d72e5272a8ecb27123a8f375618593655daf0b79318cee668e9eb2041986d0e5384c831a19f95b54a741a0f7b4bc03601b7f855c7dc7d7bff0b4dad7e3ed3f143489d9ae5e0c084643045ee760fdd5da081859ef88b2060c20f83adfb5c0fda0df144024322a93019cc0e4b119b8b87c9b578fda7affb5dc5c533368fa65f883b69324d325dc44bbd1df4c71327571dc6ae3fddef159ebe79ad0f3103602d6f34fe0fb692d8214b8097bdc2dc82d67afd0b797dbfc4d52c3d3d9964bd832ccee9060fbf46ffbc7bdcaae4052729a255f50ce7f141c664b7b066c8928a4883e9c6bdb8f97dfee795346d3d37dcd7777cd456deba6d8d5d4e9b63c243efa6989adfb5a4ad13f8208a476e07b8d999e6810c33606fdee89684ea1276448dfe4b473dfa9d49cb1e2c241a5d7c2fd492253a09c14395ad4cc50844ba1807a28363aed5849069875cdeb72a2d3e7e5e4e374676392092e2b0927d17017be18ec7348cbaef8c1ced08b16e31f8fd345a850900bf4f168ec691c1973d96e71ef63c92c6e3423c2f05b7097d46eab83125372a7ef20a415306422849f17e5b23adf465b3a18beea02f2211ed4ab819ab2ef4e1f013296691efc32a875dd356506171b2e2150f4c667f1fd67504aafc4e957e16113d7c3b2b101715e29f2791e31df3067b98045202030dbc55a1676ac5ec5596c546b3684be7d54a90ba39d78a307a972f62ac32503e2ace5192b7f36ea9eb8c6bea3c7011956944ce27576c8f46181fe2e30e50436d8e48f3b5088c791eb7cd304efa694536e5c4fe0dae83ee3092c1060f9aadfb9ab507e3cedda859c9770540499d494812b4727b92db9d9c5865a9b82365dd05e65b11db16a95189a13cd7ba3b70fe8b0652259f6b3b5c82d78d762b627467865b318f252bc7c684e42f29516f2e76d37771afdc1b5f258107552a5089233f3fbf6fc6d94686252db87b628593260ffa3da93b258e4cf082f38e112a33b6d8bcdd830589f4c534f99f98b3090651346a84d5accfeb04a9cd396aa4b6fc272d41c7d007c03ae02db2e538206340e3cc9d7bb4ee1fe26e0352c625506e9cf78e9186b837df35a8dc0a3f1bfe27e405656d9a093a7eb86c8e30ceacbd246c97326650969857a0587c92127c072c5fc6897f0b0a99008abbdb3d93cc28f3d7c51c6c7c35346d215613dbd8799905f55aaf977e0af06d4bbbfbf54be1229aa5de358383bf271638c04d61d36a04279d08ce13b3aeed0e8a6296b1d1b965f504555afc91800d61d64188fe65b16cb4f33355b0665505d6b4a7d89e4c328ffe29aac8e087b689268340f5eecb58cf0e787fddd45a0702156ddab68ce2c06c44ffa27d7d0e4c468043a0a8bc7913faaf625578a2e0d65239f3e270d1d44c6a9013ee93057d9afb6133ff62d5e71832024ea3da0032468b45a700d1ccb9384bc177770e96b1aa465ce8f7f0b9861cb930200829a7a37cd70b3f446682f66babaa97743778ce918051e2ee37e27e2455ecb1b5d7fe1614fadabb2b4198531bf2da3502204dc28ce80026811a8300fc2422d31c32c025f7094d0f254037d8fe01355048643aca51d8803f39d61c6e0b827f310292c37ccca5614162829c23f86c0d704f72da4e42e7526281e92b5aa4e531d03091a0e33407a2d9b6ec5ca92c6597bf969c6936e2f7448f326169d7a9a5e80fb2c3a1cb1dd24378a29106afadc3bc5c2897f6af0721cf734f2e114b494e02f33dc6a0db4cdcac6af31821a3e6e7b9f5b7440373d7764e1dad02b9023592b63230457ed82405f412481aa849400cbd7e28409",
#                           "91721b4dd0209017e37fa59b201c74b42f9abfda08fe83496ee7b4d20af8dd565744634b9edcc5a2ba32a5c65e921278f19f1fa0aa69bbc45c86587a090fcb8c7837c64b866df0fdd379b7d6e040ee778c7ccb32d29aca4c957aab69d2f4ebee2a79897403c6011e2fae67b03b87164813b95b32fd6adcb1233232f5ac4239acce9957a9864ed07bf03951ca69235df4b9a2f7cb2c09ca7f5f9b5eb90ec734e305572dd7b1cacf8a0dfea6b03c275b0f529eef81e6f582f72d52e2a76497f81992668224c00a0c413ee769bdc01da532dc578f77facc1c27fba76b1cc60418f96d514b95847b765880356bf7e1dd6979d90dbd33cc7d8d9f14011e88aed22cad839ad9dcef5ace1b016da2684aefdc11b522e3e3b10f1873b86b064655c02d3d8074ab819b601ecf3c0c88b11aaa01fdd482fb7fe4066ff946a2b90fd559e3d117f33578b461fbe2e34f861b4d49f1919495111b1beb19d292cacf1cfced99a0cc733e638eee1b7b6ceb4dae5f63b2501a75a241c10c644ebecd3086e3f6c684d39aa01a6a245b71bfed9cafd1bca26c2f13cf07b1fda7317def8fe9b1b188bb82eb127d4a5c0c874eaad663183ee1fe09e5d5246b2942c75cef925f2a090f59d32ed08de631e51c6592cc42c73d7017976d92d3fac28e32b2e9d9ff6e8af0028c0b6cc29ab16482d9fa05bca12d16946dc90a0425baf6241a12ba8def9f261f47e6c0684048b0278e9cc68bea0bdd17a802c6b7b3e832a41a3583435df082fe1ab5a21dd27e8e30d9de1d143ca5b2909ecbbb34f46da86a6bffea562089e04de6f12c08619d76b322c32bf19e4e32de67365f8ec1152c093bf976c5ab7edf602f374231ba23d9271869991086348923f5e00127d120856790089c1015149b3db2fbc3b4d312f0d4a6c4414eda13eae33165680947fb6d4115239ea8da29dbd43ed9bb633cb62ba304bc08f007b946be231e798381fe1cacb16d0e6daf69c69ce80383581f37982a034576dcae55ac2ff1d6643e2da98e7d6d04a9108118c7f2d757a6e9f5a0204f34453d20e43763ae3107a8685fd0dce5a00735e7ad7824a740feee654a4a7a7758d3ae82868151d6d325cbca8141bb7d1cd3ba06bc4f31b4dfa640806b2f848b6e6aa97031aabcb8b2067e7168fdcb7684e2a82d92e86de38199acc0e934c0ddf8bee07fbb5c4508b37c0bd81e04c27ba8e16250b3fd1a3d7c14ea3234aa13d80dde4d6d414983b8f7bd41e50a3eddd55b9ed5b052371b9f9c376e6e3c2136376ab006e205497fb5907341ab228fb0bb6d404bee4481ad1f029016ca1aaf82de257971f1e1cb6df5bbf2ec6ae24d4fb4c0fc30cfa5c2b5e39bb6496ee0d043dd8d9c1751830884c8a4d85067db1de6590c43a6c0f4adfdb57f3b22d065f2b91cc7ceb105e28d6300b824bf46a15a92061f4bf83effd168dccfe68ff8b16eac65d3b0659d159bfee5f4bf365d498f69d1d8444a84ef3d11ab38b3fd385f1398a5011d4739d1680c70b7cbffc76114b76e55fcb969297d57a9c33d5e7ac1f2066d22b976b47af314684324f72e1cc82104928c4845f932df32d71542662e3d3af2cb285579ce78ee7532f7f6a6068b8552eb7ad7f6f0686eb8ac1efecab3c83b9c2ff2ecbcb9058113ada2b51a015e1bf22c7a1d572fc427cf1b64ebaad990f970982bdd0b3f60c8ac0a67433c6b7eba97443b8863530f92e6514a0085ce600ba13d91f6af79dec9105435c56358d0ec8d4289248e1380324b2992523cde2365c55f24d20609a05ca01f300d0f0e3c3684342c3730853672980657c1d8269af12138499d69efea0296b5234f3bb0904b7fbdf9659f2cbe7279c0ed7e9e8299e408bd686201b24df2a9cae71a93a8e2f8fc9fc5a97660971ba22f256778b5ef3c23ae6605cb3dd4bb1739db26d47709b08cbf0b858bdf960802f13206ccd2f9b7fc9442e9ce41649a9792868e964e8323e29ec5dc579db276ee62f61a7c87a99a1b8fe0b1b72afaa9a26943bde5765a8cea712f4f71338bd98a9670fbb6ccce083ecb0240c181929f6ebd2a82f441b801f",
#                           "cf6d65b444abdff27aeeaa695cde825b40fc7ea2b798ec7d822225b7c6c379b9b967df033809d2270b6f779aa6f8635aa6ed628fd923df56748187af5474a30bc52a15131ec32929d49bfef5c4aae1c9378c4a59eb30bf090b6104da1c8de4d352fcf00b8088b883cfccf077e9a42c0eac162beb01eb47c7157bc616050739c9f3c509b3af8953dba193ef62ff1e77cf941c6f5eb53bee6bb8509b6d87fa2605ac1c26283bda15c8bc3714918c50bfd4d176ba5359af079ab1a77609996eb11bd1f7e52a3df03289446a7c69b23c15a17b35b9378eddbecff637f0c151d62a5645e7b61bd6c0754ae46da867ca5c2a80522665b5988953bec521545c1131b1daadd6cafc3a61cadb26dcaed0110887eb52a7ede4f50c08c7eece0d3be3c856ab9b2aa01a6dc1ac25b17d1166414cb11dfd57dd2b3c4acd9acb080fc96289f9ca4476afe9454b61c84768cba6f818e2398b503303e7cec05468172547414fad09c7aab9c7b94fdb3b3a41aeafe26a377606abd42305fc43d25b92458e71fcf871c94d2efe5c5a079ba62793893645ebb5123adb1a8f3a56697901756b3b8142267a4fa4e839e6e4a9c6f97940b7be665557226ff70584644c905792384f037c5d068c84e2e1fb7b88ecd681b7d84a21b89a71da171d2545dd4e5c10521fc863dd432ce67afde7c1785f81671e2442800f98595e49baa262a77fcfb43411401d6d167c8cb722a61a453d55538fb68e04522ae3b59e8560ca2121bb3bbebbbf84005118a21e9e1fe9976444ba69f2b07c493293aac4d611bcff25dc006e0769b062d3f4397afbeecbe95ba41aacbbf08c2983af6ab02fa8dae1a14dda29ab69cffba0a413f6a6f44c60af732adaa196a2199da793fc42195c311f16bd0173f286553e4311b222f4448f930b9ebcb6fea4ac0cf5b8cd2d8e3ae3bbd5d3e0ca567a390e670766743719a296ecc2c956478d69f31968b60059c4ac55bfb467770834938c95a357cae14fe810fe7f518007a700cbf00013589ae3ecd0f37e9374c1d95baa3b47da0a524b5069d7b111ccbc791aef169d2c928136a9fe509b55f57e1fb12270ed4a1248685a18b1fcd6d6680f05797be85191abf6e427b129f33804deeb7eea5189ddbe2b047ea03cc57a32c05b21ee58dcad9ed3a9b101c5e117aa45b4883cc900a9d0e4328f431756141140921269764756de7aebb1c126798a77a62e2d45fdc08f3c52059ccb2a5fc7e66c5fff58f3eafc6a4f637de9544d2c7dbb07b50d36308b20627140e90e2e33ad4ac9d549b9138822049c4ec80a3fdca12fac3d9be42d7fcd8b124f81309e16e4c2b15abd1ca2434447d0d81ccf608b4919a55092a0d89f3d8648c9e35011c99334b9da84b60158980b1034f1720351eda62842e62d2a3bbf4633408c3fd7ef70a58802dbfe3dbd9738e335beaeee6f3ca108d2507290e28de77a96ce86fedd6c3c8e9fbbf711be64da9e90664acf5edd5ed164a5c8e4ddffa442fbe3604b4087e376da43cae9335f4d64904ece842ca3b7300643021546b43e837b569c943282c2843bdb6992ace645123bdc6d29d683c49a86ae9935276f17ceced0bea7430cafe424bfeb8791afef127a455b23b1bb19e8f8b04884da5823db2058cc6e494634a1fd728b32bb18011bfa7879972e8246862969835c17f7995c4443a7f0cdc3fa05edf047ae6262d3dd86a49c6ec03d45265f326b8f81b06acd587dca8191019aedf924b7de4b2218c5dca8f88179ba5a96cae2d718f6a88af1c7e07267db445b247274abc99c336d4a7c01d0697a04a3f96925f496604cbbc4d3187691474316825a6c381ccd125ffdbeb5621aa248c7d58b5bbfe918a8c756276fc8eda236fe21fabb5439e05e08e9d3100d2b69c48b303086c721d79ef6a5b2bf258428ecdcaa2cb3a11097b6be7dbb509347752c586223fd992735a801bd713bef4f609af120dc4cafc08d2f4bdb4d28ba0371f4840bdb471096bef3bd108d8cd6165b9132e424289f256853edb608ccd1c785b25e39b762596780899788ef4dfe2044a48ce74cf4a87f207e") %>%
#   paste(collapse = "", sep = "") %>%
#   sodium::hex2bin() %>%
#   sodium::data_decrypt(key = googlesheets_key_raw, nonce = googlesheets_nonce_raw) %>%
#   rawConnection() %>% gzcon() %>% readRDS()
#
#
#
#
# gdrive_decrypted_raw <- c("7e16861042c2a98f5bfc16c417cec402de341345df7b425e5e1bef8ed585ad61ba76406c966214466351af1677a4222f9d22a78beafca1904c92c5bc14f554d95024e3f0c649675527c10ff9891aca680c39177ca61feff8361ff8ae59f82d4a96b658c2e5c200d3be949b91e633e8b3bd9e431ed15538dc3fa370133db7641e431e39aaa8063acfdc0d34eb8dfc2a8caf55a66c8e01957256485e567d16cd90fd9e37cd33d26928e3f77d6fec8e6e0849cfab10bf6cc8eeb0ba468a1cc0fd062622fe448bc82bbf1b014b0c4de67efd7f6999749dfb7bcab6800314f4eb6280a52b6baa84e6b5abbd27f004341c249cd6d8f1c50cc975b04dfdaeab7b6706e9b8ac52f33c71c25bceaa53df61fd1cac78f35e158b0124cdcba0dbf1c26858906ad3b9660d6cc35de0b09f4cba617eebd239b9cb3dbf2e674f7e7e75719bcf16c3ffb9ae5dd5c8e0b5ef30f96145ac96f259a76e7e998d28fa3cf9c6c9f92cde6adb87d2d432feb0d5c6b48003ca319ffa28ece3a6f1325f293438f71ead55ec5a28567e611c6e1f073ad7db9f3b774c2b214ecbc900a566718db0707f85ae29e6431c0a73f180912c41eb24593198743add658f45a0d2d7e6564f8132241633879a3b5a8cd4e73efde73a25d322c59183d173c2c678c49d4a35573504751c11d820e07323b77a2995d52827f4156b7624e5d3dbe10926d96c152461ed2e12f300a2f3f53f7afa58c0e46481309d886273f3da4b2c6870a25fad32379ea2de3c3b44f27a1341fd068179a44bf737ae0611bb4351c31dc93b3f0194b17dcb87d929cbc7b80ccfd662c2cc47e18b33be11f27f48801cce2ac120ef8805aad30065e6e9b1d6384c59a6d8d7bc9767684898541fd6d9172bd4fad7a3f5de0078c88572b67b9e08ae14e573818be975e544cf8859680841c56aef22963c2ede66782436b42638e5fc0cd70685e32b48621235c574bdab0cfe9cb68804a8ddbf00c55a57c4f6e389fe55daec1d20140aece84d4e53fd2cbcfdce8bf1811ee1311d934dd76dfc00fb2ddf85ec74390e4647a2b59fc750dd0394ee4bc8147537c8dc09a4af6fc74ad408772d8f444ab4b4e92bfbefbfc16376591329f9126431419a648e64e5430d1ada563d5ed3fc418ef812e5fb65c56853002f150eb8851d934ee2606bfb2f24b839d02b7f90b0cfdfad6e20259bc1937c7726323b55772f570d2e7572f62675b29e481a24d29cefb9946796961a91b1b9bafdb09d1c8af41a49b438c48d6b8c20aa1e0cc547faf0b0b7f7d948d65136f94d81b7881e1c9fc6d01203327e2814a991dc2a047a300e9d74695d3d945c9c21642388bc22da2153e9b9c94a5ac4b2b8d90e090611296d13f09789091a661de70b4a15264339d1662642b3d826d545362a2a1ca5910cb72e52d68f4dfea382ea8cc8bdcbe6fd842658824a58d70dfd173c825071bc440595fd382d5df6a32972d7751ba091d206a850eda28d52c8ddd0e6f57a97b4a74b46b57ce8088f7fc5dfaa4c0e61a0bd43893c0e435ca177812e59284ef18d43f9e40e88b033d52a21e0c36e3176ba070e49919211df8261dd3c1306ad17908636fb7b32f060a490cab28e7ff5929e779ba5423a5e328276686973c97ed1ad72c676fbca377fe0cd2e078d5f42190f78d01070a5805be0298300e9b1866744b243464bdb35c55c9bacba642dd5b97985d3c36f74a22c2b9bd1a2e6c356c3a877711dd465d809eb99882afdd364a6618eda0ba0681e13c3e89b68e5ca2e9c0f7aea521fcfba6b5ddcf34d3bba8535eb5b37d7abb50a0e0fde1b48ad6215a0bd1613a7d1e7532b428d2712549d0533908fcbb9f4b64b52e66dfc4adc3da4789800c582a769ff17de2a593376d5e5688e97ff12bbf62128d2039aee08d5f2912ac3e2053936b54a695ab2292a2feba71cd31aa8e14abb0cf4c9d79943f9992426f8483138385eabb8ce6cd10918195b059bb3b6d17665dcccc55fcb3b09c53e9f05376f888d6df63b58cb0597f0317dc1e9bdb8813bb6421aded955bb12feefcc60b1eca07313ae17262fe8a1",
#                           "bae70bc6c065c041f4a5ef9108cd37e2059c26caace603b95f259f2a4f3981b5245cae6cfafd608deb71520e6067f58a4f5956975f6a459ca36a573548141212ffaeaf0599c5b28bc886e77227cd347ad0a834d2aa4bd1934c5b43960a07950b5d19f986c8645d49d5c0173329f20b5c9faaa18c19b18b8bcee7bceb4f3b5eb7c2af452289ea8e2c5fd92160397fbbac4cd50b3d5738e6f82f10f610fad032c0aec31b3e15f8cf6b5b85a1e2dfb7d9fcdedae1dd718fae9a03bddc8f8bcd86589b382b1378831770b4c986b3c9d8d22d591e6108d8f9051a472066c7fd4d074b46b6fac903de6b6bb65f85f61b2a9da43dd4482f95c05938d3d6ad5f833c936cf03a18d2c1f7ffab66831f9a78733e26fa1055e42501848363e21e4ac633e977aed031274a353cd5939db7c37b241660eba8d64facaf14bb7f2030c32f217be009bd8e958fcb11369b9e7cf6c9fe50e90c9dae0d58dde63597eeebd937e3188c122ac75cf350f9570fb6e001228ca9f0b873060e146639c6f41d487a4c5d06acfeb0b1dcf9203797af550ec6f3b935145e41c032b60279dc46a825594346f129f132eeaeb8457c0dc44a73ea17a0483a21b7d9699e78e9ab141933a023771079943da14554aa1eb0e687e5a1a6b7752804576949569bc29f05685ca6b2ba2771c1b492ff44b4f9cd11ac35262556b0c3227e3e2826f384ad1fc53cd42df80ddfc190086fb0498b6dac4e6ce070ba647d50c1ef02d1a93fc0b9619786317c2a026fca290a2ef97136fbef7373bdac85218c22185c59dfa95093c3f9111c09b71df39d0bb542fca111d093f280d6e4cf37b4d9c2392cda1c1b53972ae123c31c2c9208f80dd8e0b448deb94b1f9bf9721a90e5217e01ab0baddd6acf529749479d2dbf5889691c8a0d65bbac0749e5021efb4ef07ca4c2438ff6b75387982c374fe2dc98cff7185d0a7eb58ed7681102d3961787987c5b7350407ac984bf84a0456f02c6487b1ed04c10dc03a8ca931ebf9a07fedf02c8e621df0fb9aa817a07369fb6914a80a67870f56f0ac231d2c31d21b8e14da1d273d91ee6e9f77c903ded28c01e1a11b786ef8e6dfa5b1b29d5cae5543ebe71fd2db77813b4a7b544ce0a1eeb1e3d643714ff52d189da901d04c939af92ca9f0836625b53dbb635511b282b8c2f47b07a487a50bdbde97c7f244d9dbb40aafe3efb3a13b82ae3ef1a729509db972116723ec75fc267188f12649ee16c1c19fb39309fd77ae2b3696bde9aabb525a9a5ce52e59e80d43bc6092f2ed0880caa036741953863fa720e670cee69ed600a324ba147fa749e52cebade02413871ab3e08f198dbfc65d49859e050b6443e23fe2e13931261d9deadc9382939f5f18b671f84f49010200f4fbe0fab5d932ecc20dc1e155ecf5cd32a7d3afb457086064df869ec280d8a7321c8273b40ba855fd4f1598d0f6cc3fc3624a277cb5bb1ff41ac552fee11aadd236ae94b8ecdd13a2cc0512128ed17bf296b5f1c67292ee6866224a9adae24e2f8f3b91b9ec996c442576b9f073800fa5b85d0a07a40785dc000af7b92d1a6386c2c1240f04611642f7f106e80d4ef018761bcfc8494a11dcce55e8b0adb811188a9c2e824e4356c6e3fa221f340159409bf4df379cea20e70e673eb0c7c0b49eb6a42c6f8194c3bcf7eca552cc0af979bd51f6268e99c3d46cf005c5e5cd1b613669946a7d3db5a5e5c7d5da1efd31c232791143c880be91343abd85a9075c5177b67f6ad1a1ea67b4ee8d626fecac4607aa777b7395dccffbcb88c3f4d737fffd4e41516a0a71c72a814f3c44c0f13df1ea8a6f105660fe9762e36b95239808800b83679853744a88d7aedc7308a2b43555b392d0f5e30acac93e687cbbd56adba1af0c55254704b1212ceb728f53355a1d8d8c59e0681ba64b506d9dcac51665274fe1fb7b350232ae713b2c43e3eb435c074f0579bbe20c072e31e722500df4452de7a0f22d399d66f778ab818b8f89f5b99b0f24e3c4e567def29d5d1c50f5d086a6657ad3473b2d168fcf901526140d81d2f055f090f2d",
#                           "f7ce17fc561d3dc1d236a1080b59d8640aad9483b99028b66e26f15bdbb8c7f666de1cc7eb438832f7c3fb991b5083e2438a103b8ae4fd469ecf588fcd8398d7b4566cb4b0b60a0f80135311f60365e9a7722c88a1df6c97097b65916ebba7047674b8355506918cfa196e9d07913450590b86931209d54ba2ded23c4bb4cb6089de61c93584ce56a2a4580b658ec02d865a1ffbd8e524022c60c77199fc35e6d1c46dceb78843d0ea598509b4f8b24bd46f1056e24156d829fbf7275cf13331efdf5b030b7f2f292d2a14e05a72fce65d7527489a36a81e9970e9d4117d62cecf11c180fa77f641bdd6c646394987bf640eb05962981714dc68dc60e3dc1a7403a45cf25d60d89930c6b5b397ff6465175eca8c01b1e1952b38c74eb6049a1518cad73d4afaef93c80ee6c7fdf905d4e2ae3107d453e911e0205ae92f887c120188bae7f4fb8d297109aa6932ae104f660ef7634fe526f4a3bd4609473f3bbc0321fb3fa3a9f4c5005d9841b9a59e92d6edf6c171eeaba166aede2f8ae7716ab1849316792e3b5bc511b7cc05371f81381d94443903ba0db4cde93fe30a46185369e0da57eae90c6e0155751b6e3eccadc680402c1c58c1a2c25cefa56a3110b9312dcd4adac9efb7cf26a29d4a8ee00472c88c65509d45c20596e77a3c2726de9d4b0d1c6ca3b53c47d7c3bc2b54e83a1bafb10110a07d3a62d3e3560f431d832e918d3173c9f7ded0585d54a1a6f3cb29ae35de3f819d22c37ee0e8a7019038877ac6f8186eb4d74f84dd116a0ad3c087b5671324714d78d55a62ef537f1b767859e45717966be2b1a15474c4582e97d9161407e7bf31501874da57d0588650f6d932398e02be384ca9743682e93732b776d6094d7681663dbe03310a2efd51db6a54f0e460ac0006652c2f2f766268df760d32c3ae6ea84b6767f79aaad4cc2dae88daf1d2f9792317fd0c5672bd793de37c895f89576227d3624c4311ba80bcccd789cdcb06a3b7a9dcf13be6ae4422d8c0c9a65f847ae70c2171421e842438e1a19885f63208d05a7c0ae01f7c8f1959b58dd64b2b2dc8f0dc737f3836e4b7702cb34b1ecd7f3ff54a5f8c6887bc0348d2aeabbb800cda34af2f2b8d4e86be43a45fd8a64bd9845efde48c622d37709c21512f1a61ccf785d61ca2b2ef5d3d7a5020b88ae45db0b1036c9b42e3c18991037fcf27160119b814d074fca2ca3811dbe3fd187a0607bda2c9c17c92ffba5f1c0e7c280ee3d769bb744c15b150f2afd3db98a7ae91f81cefc1e45c066ff6140bc3ed24e9fca4c36cde2c29f292ae74bb61f02f6b20ddb3bdb46fcc0f89109d9f5e3bb7098e8a4302af42e1ddb9308b89a1abcdaa6a59f2bb0a5489b939dceb593302b2d0e85da1cec1b0215789d206540e1b431cf30f68f0fca341eacc2d61b2a86268e60014fa3595d59c2a59592a4fcfb9dcec19530322d15c78d881868515018be89ab5bf3125777d7b1729e13e6744ec0f5b30614524b2c1b03259fd7337721a3c86cf9b45399e7dea3c3d201c835ad84d44f57aa78fb9408f66d1750087553bde0a7ec6284e1dab978f21fbe73c09b082e1be7ac163b825f554b8b802d39eda4287db6b54e0cbbf190cd11619f9f75d395d90b1dbe52a89cb803f5b238ec24119bb95f3f6a4765a743baa5b4aa6cc2e715b98708917a86b28df977b329b980a984eca9acf794b9db6e03cd7de6b3ea1039fb3c1a6100abf95345cc9f5d5057f07ef6e55f5946192a09fcd7e9d763c7131f7493ed874de1204727d8ba25a734aae5b482216893797d69eaa0dfe4cbb7465f627fef45b4d34078a063c207a4fab6b714aeb3c96ef3c004ec5f08951dabdb29e7cb76ae59f8851e1f691f8029bfacddbc48d7d7ab4aa745c93071ce2c13b8bfad9e6184bde82fbbbb19b63f8064a3d0ac85d12237f882f0e2f759b567626a7c370a7b7b8a833391e381839fcd47a0a2b9b2a8c654c9a400f3c8620aba33314859ea677d2a610ae5b63b29bf302ef95189fbdad8a4fa1453587c2d94377539c36141671fb5b804c6a7c6b56977f67",
#                           "83ef4751229194dc7b837055494f4f45bb8b0dc2c3e858e6099bd6972797d5a9fc4752a4b54f24a2a55bbd41ed691b546e7082129de42b78eca26ab27e5048452c78a64a412b3971388d663020907fe243d0256c31458d52d0824ca0facf9fc2fb1f86e94c267dd843afbb9ecff40762504d673dd8f639f34f101005d824793945c9af19fedad47dff5674f46ead797b761cdcb2869512abc0bcd76d358b110f79b08fce6447a3579ce1691f22dde0763332deebf4a8fb331cecd9eff2cf8603c62569bd898c7ae4b8f9694e10586967a8412f025be8cf3fb53e3ae84222d9757d075b9072495f5adaeb57c9721fc0f3a1280a1de7b9ce91849daca28731ea61dcec07a262349bf62dec8b7059576c028be5f3616f30e8149e61e6fb3a47c8177212a6f3bf0d78d5f9451030925921957e413dadad57f8fa4aac21c6445c34b0dc8eacb5295de229444e0e2875f724398f15dcb701654f18660c427fd9bcbb7540af73a982737f9b654b4d2796d98dff481a600b08ac6c5a014888fbfe18e1be261adfea54e935c60ed1e51248859b7a3472ce759459745260b9151319a382de2bbb18083822591c3303bf953c0b50204215222031b3e0e10cbfdf241399c0a79758db28c004bb1a5b51e8bf8635f28b7c010f0dc4c4d2ea8fd92d512b4880c392c45a4fd97e8bf89fa018cfa3aafd47ecd7fad353520fe2d32b981b54719bfe22c33cca5f3ecd0ef6248474a815a19fd6e3e0d904e8a3226e219ad575970ff3a9286f7565b7c83817d4b687d00970f4141c97a9fc181c2bdb278d8c18d3daf4d59079cd6008b64ba38026ca0f6ed01903143cecff52a282114e5c0dd030a1b5dd4896aa2d351399776c9b72c7e855ac002194cdeacd39e8b0b09040522b49f303934592a465825632d9c15a8ace533a2dcb975446974b777fb7fc6a9243555c4395df6515b223f24549b322c62cc15eb86666fc5602e47657aea7d74283922e47fb7fe7888c569437a1bb970f9094dc5e69fb930eb184325a2f8944249a282eb230e7e10727acb12fa207efc9bc7f90bf4201e8f03bb76fe96c4c1e394d5db753118ee5c7e61453e779c8aa96ddd334805c440e5dfb7cab0a9107e0b54e9689ec7529cf08a7bf5cc1cd6829014465ebba87f669ce7e113ebf8db9c53bb113a1a29ce335e86251b5506ba9ac28291e49b441256ce4b4aa96641614e68c85cc207ba34dc902fad7a9fb4ed2fff855ce76e6085c32bc2ba73a632e68bbe960709fcdfe3abc5e8be12d9096e916706994248021d17fe7606ce8829e3bb15335fd7de5d8bc4cc3239fd60281aace970fda57b7877def52781124164bc4872ce6298cf85a2c901ae243d3a87db2d840ee417ed2db345e08143ba132e6ceca246fe48eec298dff5c96e8619034cded91eb9383c9d8a899ec6f2af21f2225bd2f55591261b6e31e2acb357b6bedbb0c291146d5d080d691ac16f92fd579daa0fca4fdf7af863d209914170130b061371e5478eff9f18ca41017bbda9e473a8b766da3fdffa36783c26a99c7957f20822f285fbbddc676768408c7ba1128984550687c7b7ff522a6fa4d86cb32f5b8097f1f9928f63f4b941633e26fec5b5b53c85228f9a753af1c9e70a6e50aebd09eac751b076f5ef194c6b7ddc226a9832f81d023625c24619a444cfab701863ff75666f3c16ce1cc11e256a612ea51713097a8ccff884e4ab4171c16339231cea921fc11ce881f04489109a3585026217485d95995b3737e380a629906de793e433d79ffd5587c73c9e628126e3523dac698ff9c7bb473e18ca33c0f25257d0ab2616902b23365d4f35e2f373eda2eeeaa5768b5bd04f0aeb1e14d07adf5a03a261b7bac263f17e4d9bedccac1f06efab03e6ce1059ef4db7fa82368b07201e27533dc62d8fee72ac716ba9032dd3f89412e87de5a7429c965d401c7e2d9d6643e070831fcda17c9b07a773ac0465686a1c0a2234403eebdf29a205431984c4ab3f2945cb2077fc0f8cda8e76df10b859c8bc8e35d3f05af6c8861357df14c35f3e93aea4191640e357d54",
#                           "f37e65660cf95334f4a5e313e3100af807a9de95091ebb20bbf254754c9de4e366168847235633ef2941d79c8e0ceadeb0f877b6d23201b5d6045773d8f526eca8ebe95beb2b0e2782dac0267b5635d41600aedb95675843e581c482dff541d196ed3b3acdf57afa7280cdeeec3ad3a2b2247d371923cd8f8ff74d012d247d14a52bd2fcc1b7210dc0394d7c9e3604824e6f06cdf13301b525297664cb91b41cfb988fcb9686793f96094429d86e9cd2e19bfd86bfe78a7a214a905cb017145f85517c15a6613d7b97401e39f992b6bdf4f0c598ef9777cccc23653c7721aae74ed384cfc87faf22f2e7757aeccd8d0354927e43acc7e0ea545b5cc232afef71e2ba8416e6083ca7722ea9dbc60a67c40c15a014557cd141024898936be22ba97a0f832a82e4924c42b3ce2d62e5be6366ea85baee8ad7ac60efb52081ecf6829ab99d5f71306f6a3498c93015228753f5e5421241785eb002ec6d33956662a0150f5fa160b22c86162dc32fe8c2e5d3f9e432cdbcb87891be3f0d5a7323b4e59246fe30afa98a4067ab547060e72f8c4b05ab7217a312069f19b9a7c4986a22b353c9a6cc8266f2dfb0beab7fc2c86e0ba5c62824dc47268afd7e78e4f3d10d35eefc8d2a61055662de00930b8021103b97c7251d91806bb45aea3aad1832e126501ddce4596375a3efbf4f8261ab8f6e5b93f556770fb3ef365ff1ce8193eb6d6459f194dfd05143b1ab10e1d69bf3b47bacd4ef802cfa03c57d3ee8433b2866155bb2c2498f511b6a9185cf92f6d7000279c436491ea2978c138e0be194b883a2bc5824456b0cec2f14b0ceee757b003dbec890f35b7ae2b65751aa9f46e189b39cd43570855fa81a5dcc03e59f54a25b6a6dcf56394850ede06642af60da47bc7b66c66528bb8462abe48a05f0387c05983037ab50df7a654ed0c9262a7144c80efd495611c3373fb9a89d0f6d505b5e45914378123c2275c18524ed599b17b3c72659591ac72aef812dd3445cda828346c0cc8adc41e5973a05d100cb39dc42d6f2305e49c036086a2cccb504efaeafdd518ce801768d31182fa78640e4105c492db75809c12121b5a7c7e7d433e11fb985396284b4723fec34fbf37e1912519c408bdfa2de0fbb259bdfb816fb723097c34edf625c94b8b5adc06b69198b3ac4703861620f5954d0b956782d52b732789b9b68c26f1a6fcada4da8b31715da884016e92cd069fb76df3e96743bb2bc505c2ef82a9b9c5a96cab394e67e66a27cb0bf3486de14ab295eb5117fc492a5bd225b6c9c1a4464454d8b35894c650a455890f8d099904e21959febc8d586d691f2fcbcd3ff1134b26c201412ccbd27a4d808d6e4b28967e7d549e7044d41fb0a4e9a63131571f7b7c2351d6f814fbb993deaa2d8598e2d5c7b9500e2e18b7e96a40d87949080a38284d6d32d31e81c128968aceb1ff35cb6895ee2be3af1e5342365576e137db8ae3d717f34e909bbaf046e3c5ebed9d6da8106503cd0659ed029ccbcd6c4d37bd01d54b0698d2737d427c2cb89d1a9c7814a0f60854665c9037ee0a9bc0b5e5a3536ff1e21738ff2e7aed84d83152e775a08555151d2b9b3ea3bf762cf9d588409d97bbad0f5892de06c39c1e88192241caf0aa5febe664d250aaa052ae93c713c4025b1d382b69d21bb9443e62f4df2af2ab9a3023d56b5398832fc8d41a6b1aeb25cde28e6d0262013d102fcafeec7703a17c978eef2fb912ba29862ad5e0085b578018f27356e866b567d7024b0c1aaabf1c214176cc7b51b5e3e3f492271adfbceb299310c8ebe6776be4b88e1a621a94c0127e77ffae1c315fd459db2093099472494bf004b0f7f99fab7e63154368259cc1ffcbff1607cb2a5d0c943f720cdf43f9b329be78473f3b38af0943860e950a3aaf26f90c3506a7a3694286d152a527abee059864dffac7d9e0518aecb8abcb2ed8991b69e7a9bea22c482b0ecf4346216e5d357358360c55bb8118209b6ab19217b1b6f9367e23347730df14b1988bbfd87e497cb45c5a30ee74116c127a3a4d4a6e6a7498eb40a") %>%
#   paste(collapse = "", sep = "") %>%
#   sodium::hex2bin() %>%
#   sodium::data_decrypt(key = googlesheets_key_raw, nonce = googlesheets_nonce_raw) %>%
#   rawConnection() %>% gzcon() %>% readRDS()


# gsheet_filename <- "d1bb05da48d2592034e43028da40bb29a5892c21eb1e243c6d2467d6d9c28291ab35730c0be5f221f8966761e0a8fe33a70361e1997deeb1faa18ecf560439cde1cdbf83" %>%
#   sodium::hex2bin() %>%
#   sodium::data_decrypt(key = googlesheets_key_raw, nonce = googlesheets_nonce_raw) %>%
#   rawToChar()
#
#
#
# gdrive_filename <- "663e8bee6a16909930aef758ef6007e8f08c2f23ed4923386d7c6780ddcfd098ad61230e57b4f523acc03734e1f8f833a70361e1997deeb1faa18ecf560439cde1cdbf83" %>%
#   sodium::hex2bin() %>%
#   sodium::data_decrypt(key = googlesheets_key_raw, nonce = googlesheets_nonce_raw) %>%
#   rawToChar()


# our_temp_secret_dir <- tempdir() %>% paste0(., "/.secrets")
#
# dir.create(our_temp_secret_dir)
#
# writeBin(object = gsheet_decrypted_raw, con = paste0(our_temp_secret_dir, gsheet_filename))
#
# writeBin(object = gdrive_decrypted_raw, con = paste0(our_temp_secret_dir, gdrive_filename))
#
#
#
#
#  gs4_auth(token = gsheet_decrypted_raw)
# #
#  googledrive::drive_auth(token = gdrive_decrypted_raw)


timestamp <- Sys.time()
datestamp <- Sys.time() %>% str_replace_all(":", "_") %>% str_replace_all(" ", "_")

page <- read_html("https://outagemap.mlgw.org/OutageSummary.php")

overall_outage <- page %>% html_elements(xpath = "//td//td//h2") %>% html_text()



events <- page %>%
  html_elements(xpath = '/html/head/script[not(@src)]') %>%
  as.character() %>%
  str_split(pattern = "\n") %>%
  unlist()


events_detail <- events[str_detect(events, regex("events\\[\\d*\\]"))] %>%
  str_replace_all('"', "") %>%
  str_trim() %>%
  str_split(",", simplify = T) %>%
  as.data.frame(stringsAsFactors = F) %>%
  mutate(outage_num = overall_outage[1],
         cust_affected = overall_outage[2],
         time = timestamp)

#write_csv(events_detail, file = paste0("data/", datestamp, ".csv"))
save(events_detail, file = paste0("data/", datestamp, ".RData"))


 ss <- drive_get("mlgw.outage.log")
 sheet_append(ss, data = events_detail)

page %>%
  html_elements(xpath = '/html/head') %>%
  html_text() %>%
  write_lines(file = paste0("data/", datestamp, ".txt"))
